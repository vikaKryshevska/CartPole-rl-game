# DQN CartPole (Gymnasium + PyTorch) ‚Äî Training, Evaluation, Metrics

–¶–µ–π –ø—Ä–æ—î–∫—Ç –º—ñ—Å—Ç–∏—Ç—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é **Deep Q-Network (DQN)** –¥–ª—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ **CartPole-v1** –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ **Gymnasium**. –°–∫—Ä–∏–ø—Ç:
- –ø–æ—Ä—ñ–≤–Ω—é—î **–≤–∏–ø–∞–¥–∫–æ–≤—ñ –¥—ñ—ó** —Ç–∞ **–Ω–∞—Ç—Ä–µ–Ω–æ–≤–∞–Ω—É DQN** (—É—Å–µ—Ä–µ–¥–Ω–µ–Ω–Ω—è –ø–æ –±–∞–≥–∞—Ç—å–æ—Ö –µ–ø—ñ–∑–æ–¥–∞—Ö),
- —Ç—Ä–µ–Ω—É—î –∞–≥–µ–Ω—Ç–∞ –∑ **experience replay** —Ç–∞ **target network**,
- –∑–±–µ—Ä—ñ–≥–∞—î **–≤–∞–≥–∏ –º–æ–¥–µ–ª—ñ** (`.pt`) —ñ **–≥—Ä–∞—Ñ—ñ–∫ –Ω–∞–≤—á–∞–Ω–Ω—è** (`.png`),
- –¥–æ–∑–≤–æ–ª—è—î –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å –æ–¥–∏–Ω –µ–ø—ñ–∑–æ–¥ –≥—Ä–∏ –¥–ª—è untrained/trained –∞–≥–µ–Ω—Ç–∞ (—Ä–µ–Ω–¥–µ—Ä –æ–ø—Ü—ñ–π–Ω–æ).

---

## üìå –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

- **DQN (MLP 2√ó128 ReLU)**: `state -> Q(s,a)` –¥–ª—è –∫–æ–∂–Ω–æ—ó –¥—ñ—ó.
- **Replay Buffer**: `deque` –∑ –≤–∏–ø–∞–¥–∫–æ–≤–æ—é –≤–∏–±—ñ—Ä–∫–æ—é –±–∞—Ç—á—ñ–≤.
- **Target Network**: –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∫–æ–∂–Ω—ñ `TARGET_UPDATE_EVERY` –≥—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏—Ö –∫—Ä–æ–∫—ñ–≤.
- **Epsilon-greedy exploration**: `Œµ` –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∑ `1.0` –¥–æ `0.05`.
- **–ö—Ä–∏—Ç–∏—á–Ω–∏–π fix –ø—Ä–æ "done":**
  - `terminated` (—Ä–µ–∞–ª—å–Ω–∞ –ø–æ—Ä–∞–∑–∫–∞) –≤–≤–∞–∂–∞—î—Ç—å—Å—è terminal –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è (bootstrapping –≤–∏–º–∏–∫–∞—î—Ç—å—Å—è),
  - `truncated` (—Ç–∞–π–º-–ª—ñ–º—ñ—Ç) **–Ω–µ** –≤–≤–∞–∂–∞—î—Ç—å—Å—è terminal failure –¥–ª—è bootstrapping.
- **Reward shaping**: –ø—Ä–∏ `terminated` –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ `-10.0` –¥–ª—è —à–≤–∏–¥—à–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è.
- **Metrics plot**: –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≥—Ä–∞—Ñ—ñ–∫ reward + moving average.

---

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
pip install gymnasium numpy matplotlib tqdm torch
